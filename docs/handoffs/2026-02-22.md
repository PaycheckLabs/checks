# Checks Handoff (2026-02-22)

Owner: James4DX  
Repo: PaycheckLabs/checks (main)  
Status: CI green, PaymentChecks v1 spec locked, Amoy smoke repeatable, Explorer testnet serial routing live

## 1) Snapshot
We are stable and moving forward cleanly.

What is now true:
- PaymentChecks v1 is spec locked
- CI is stable and installs forge-std before build and tests
- Repeatable Amoy deploy and smoke runs are working and now include serial output and transfer and void coverage
- Testnet Explorer routing is live at `https://explorer.checks.xyz/testnet/<serial>` via a new repo `PaycheckLabs/checks-explorer`

We are intentionally skipping expiration in v1.

## 2) Key Deliveries Since Last Handoff
### Contracts and CI
- PaymentChecks v1 spec locked at:
  - `docs/specs/payment-checks-v1.md`
- Core contracts:
  - `packages/contracts/src/PaymentChecks.sol`
  - `packages/contracts/src/IPaymentChecks.sol`
- Tests:
  - `packages/contracts/test/PaymentChecks.additional.t.sol`
  - `packages/contracts/test/helpers/EdgeCaseERC20s.sol`
- Amoy scripts:
  - `packages/contracts/script/DeployPaymentChecks.s.sol`
  - `packages/contracts/script/DeployAndSmoke.s.sol`
- CI workflow stable:
  - `.github/workflows/contracts.yml` (installs forge-std before forge build/test)

### Serial and QR planning
- Serial and QR strategy documented and in progress
- Decision: testnet QR payload uses
  - `https://explorer.checks.xyz/testnet/<serial>`
- Future plan: later redirect `/testnet/<serial>` to `/<serial>` when mainnet Explorer is ready

### Explorer Testnet Routing
New repo created and deployed:
- Repo: `PaycheckLabs/checks-explorer`
- Production: green
- Domain live: `https://explorer.checks.xyz/`
- Serial route live:
  - `https://explorer.checks.xyz/testnet/SMJ-4656RY-MA73`

## 3) Milestones
### M0 (complete)
- Repo stabilized
- First successful on-chain Amoy smoke run completed
- Old backup branches removed, main is only long-lived branch

### M1 (in progress)
M1 target meaning:
- Repeatable on-chain smoke coverage on Amoy
- Identity layer groundwork: serial and QR strategy, Explorer serial routing
- Start bridging from on-chain proof to viewer URL

Recommended M1 add:
- Mint checks with serial system and prove serial URL routing on Explorer domain

## 4) On-Chain Proofs
### Earlier M0 proof set (Amoy, chainId 80002)
PaymentChecks (ERC-721):
- https://amoy.polygonscan.com/address/0x582b029817720d6eb82E087b21A870956777F7B9

MockERC20 (mUSD, ERC-20):
- https://amoy.polygonscan.com/address/0x1F9398438630C0896fc58375A03BfaAF3F1b21e9

Mint funded check (checkId 1):
- https://amoy.polygonscan.com/tx/0xc40b125a49eaa75594eafd96da23fb0dfd6889eeefc1bb226cf0d5b60275f02a

Redeem check (checkId 1):
- https://amoy.polygonscan.com/tx/0xb35ef4da84f1ccb1e2f3c328fe2e90db6a499a155f0303e0413768f95faaaab0

### Serial smoke proof doc (committed)
- `docs/proofs/amoy/2026-02-20-deploy-and-smoke-serials.md`

## 5) Current Explorer Status
Explorer domain is live and working:
- Home: `https://explorer.checks.xyz/`
- Example serial route: `https://explorer.checks.xyz/testnet/SMJ-4656RY-MA73`

This is currently a lightweight viewer:
- Shows serial, chain info, contract address, tokenId
- Shows Polygonscan transaction links
- Full UI and rendered NFT image are not implemented yet

## 6) Local Runbook
Amoy smoke run (PowerShell):
- `cd C:\Users\James\checks\packages\contracts`
- `$env:AMOY_RPC_URL = "https://rpc-amoy.polygon.technology"`
- `$env:PRIVATE_KEY = "0xISSUER_PRIVATE_KEY"`
- `$env:SECOND_PRIVATE_KEY = "0xHOLDER_PRIVATE_KEY"`
- `forge script script/DeployAndSmoke.s.sol:DeployAndSmoke --rpc-url $env:AMOY_RPC_URL --broadcast -vvv`

Broadcast output locations:
- `packages/contracts/broadcast/DeployAndSmoke.s.sol/80002/run-latest.json`
- `packages/contracts/cache/DeployAndSmoke.s.sol/80002/run-latest.json`

Note:
- `packages/contracts/foundry.lock` should not be committed and is ignored

## 7) Decisions Locked
- v1 does not include expiration
- Serial is not the tokenId
- Serial format: uppercase and globally unique
- Safe character sets should avoid ambiguous characters
- Testnet QR payload: `https://explorer.checks.xyz/testnet/<serial>`
- Later plan: redirect testnet route to canonical route when ready

## 8) Open Issues and Risks
- Some docs appear visually fine in GitHub editor but are stored with poor newline formatting in raw
  - We will normalize markdown formatting later in a dedicated docs-only cleanup PR
- Explorer currently uses a static mapping approach, not an indexer
  - Next step will be adding image rendering and then metadata endpoints

## 9) Next Tasks
### A) Explorer next step: show an NFT Check card image
Goal:
- Render a check image on `/testnet/<serial>` and generate a QR that points back to the same page

Plan:
- Add `pages/api/checks/image/[serial].ts` to generate a PNG (serial + QR)
- Update `/testnet/[serial].tsx` to show the image at the top

### B) Wallet-friendly NFT metadata for later
Goal:
- Serve token metadata from `explorer.checks.xyz/api/checks/metadata/<tokenId>` for a future deploy that sets baseURI to this endpoint

Plan:
- Add `pages/api/checks/metadata/[tokenId].ts`
- Keep mapping lightweight for testnet, move to an indexer later

### C) Optional: Deploy PaymentChecks with a real baseURI to the Explorer metadata endpoint
Goal:
- Make minted NFTs render in wallets using the check image and metadata

## 10) Closeout
Stopping point:
- Explorer domain is live and testnet serial routes resolve
- Production builds are green in both repos
- On-chain proofs and serial smoke proof doc are committed
- Ready to implement image rendering and metadata endpoints next
